# BongoCat CI/CD 指南

本文档详细说明了 BongoCat 项目的持续集成和持续部署 (CI/CD) 流程，包括自动构建、标签管理和发布流程。

## 自动构建流程

### 触发条件

BongoCat 的自动构建可以通过以下方式触发：

1. **推送到主分支**：当代码推送到 `master` 或 `main` 分支时，自动触发构建流程。
2. **手动触发**：在 GitHub Actions 页面手动触发构建流程。

### 构建流程

自动构建流程包括以下步骤：

1. **创建发布**：根据 `package.json` 中的版本号创建一个新的发布版本。
2. **多平台构建**：同时为以下平台构建应用程序：
   - macOS (arm64, x64)
   - Windows (x64, x86, arm64)
   - Linux (x64, arm64)
3. **发布草稿**：构建完成后，创建一个发布草稿，包含所有平台的安装包。

## 标签管理

### 删除标签

如果需要删除所有现有的 Git 标签（例如，在重新组织版本号或清理历史标签时），可以使用提供的脚本：

```bash
# 运行标签删除脚本
./scripts/delete-tags.sh
```

此脚本将：

1. 获取所有远程标签
2. 显示将要删除的标签列表
3. 请求确认
4. 删除所有远程和本地标签

### 创建新标签

新标签会在自动构建过程中自动创建，格式为 `v{版本号}`，例如 `v0.4.0`。

## 手动触发构建

如果需要手动触发构建流程，请按照以下步骤操作：

1. 进入 GitHub 仓库页面
2. 点击「Actions」选项卡
3. 在左侧选择「Build and Release」工作流
4. 点击「Run workflow」按钮
5. 选择要构建的分支，然后点击「Run workflow」

## 版本管理

### 更新版本号

要发布新版本，请按照以下步骤操作：

1. 更新 `package.json` 中的 `version` 字段
2. 提交更改并推送到主分支
3. 自动构建流程将使用新版本号创建发布

### 发布流程

1. 自动构建完成后，前往 GitHub 仓库的「Releases」页面
2. 找到标记为「Draft」的最新发布
3. 编辑发布说明，添加版本更新内容
4. 点击「Publish release」按钮发布

## 故障排除

### 构建失败

如果构建失败，请检查以下几点：

1. 查看 GitHub Actions 日志，了解具体错误
2. 确保所有依赖项都已正确安装
3. 验证项目配置文件（如 `tauri.conf.json`）是否正确

### 标签问题

如果遇到标签相关问题，可以尝试：

1. 使用 `git fetch --tags` 同步所有标签
2. 使用标签删除脚本清理所有标签，然后重新开始

## 注意事项

- 自动构建需要适当的 GitHub 权限，确保仓库设置正确
- 发布前请务必测试应用程序，确保功能正常
- 保持版本号的一致性，遵循语义化版本规范（Semantic Versioning）
